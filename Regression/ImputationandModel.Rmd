---
title: "ImputationAndModel"
author: "Rachel Gordon"
date: "12/14/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
data <- read.csv("Regression/trainRegression.csv")
```


```{r}
# impute missing data
library(mice)
tempData <- mice(data,meth='cart',seed=500)
data_comp <- complete(tempData,1)
data$reviews_per_month <- data_comp$reviews_per_month

# drop variables with all unique values
to_drop <- c("id", "name", "host_id", "host_name", "last_review")
data <- data[ , !(names(data) %in% to_drop)]

# percentage of missing values
missing_percent <- mean(is.na(data))
missing_percent
```

```{r}
linear_model <- lm(price ~ ., data = data)
anova(linear_model)
```


```{r}
plot(data$longitude, data$price)
```

```{r}
plot(data$number_of_reviews, data$price)
```

```{r}
plot(data$reviews_per_month, data$price)
```